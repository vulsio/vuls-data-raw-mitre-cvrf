{
	"title": "CVE-2021-47334",
	"cve": "CVE-2021-47334",
	"notes": {
		"description": "In the Linux kernel, the following vulnerability has been resolved: misc/libmasm/module: Fix two use after free in ibmasm_init_one In ibmasm_init_one, it calls ibmasm_init_remote_input_dev(). Inside ibmasm_init_remote_input_dev, mouse_dev and keybd_dev are allocated by input_allocate_device(), and assigned to sp->remote.mouse_dev and sp->remote.keybd_dev respectively. In the err_free_devices error branch of ibmasm_init_one, mouse_dev and keybd_dev are freed by input_free_device(), and return error. Then the execution runs into error_send_message error branch of ibmasm_init_one, where ibmasm_free_remote_input_dev(sp) is called to unregister the freed sp->remote.mouse_dev and sp->remote.keybd_dev. My patch add a \"error_init_remote\" label to handle the error of ibmasm_init_remote_input_dev(), to avoid the uaf bugs.",
		"published": "2024-05-21",
		"modified": "2024-05-28"
	},
	"references": [
		{
			"url": "https://git.kernel.org/stable/c/1512e7dc5eb08b7d92a12e2bfcd9cb8c4a1ec069",
			"description": "MISC:https://git.kernel.org/stable/c/1512e7dc5eb08b7d92a12e2bfcd9cb8c4a1ec069"
		},
		{
			"url": "https://git.kernel.org/stable/c/29ba8e2ba89ee2862a26d91204dd5fe77ceee25a",
			"description": "MISC:https://git.kernel.org/stable/c/29ba8e2ba89ee2862a26d91204dd5fe77ceee25a"
		},
		{
			"url": "https://git.kernel.org/stable/c/38660031e80eaa6cc9370b031c180612f414b00d",
			"description": "MISC:https://git.kernel.org/stable/c/38660031e80eaa6cc9370b031c180612f414b00d"
		},
		{
			"url": "https://git.kernel.org/stable/c/481a76d4749ee3a27f902ba213fdcbb4bb39720e",
			"description": "MISC:https://git.kernel.org/stable/c/481a76d4749ee3a27f902ba213fdcbb4bb39720e"
		},
		{
			"url": "https://git.kernel.org/stable/c/5b06ca113bf197aab2ab61288f42506e0049fbab",
			"description": "MISC:https://git.kernel.org/stable/c/5b06ca113bf197aab2ab61288f42506e0049fbab"
		},
		{
			"url": "https://git.kernel.org/stable/c/7272b591c4cb9327c43443f67b8fbae7657dd9ae",
			"description": "MISC:https://git.kernel.org/stable/c/7272b591c4cb9327c43443f67b8fbae7657dd9ae"
		},
		{
			"url": "https://git.kernel.org/stable/c/a7268e8a227d5a4f0bd1584f556246b0224ab274",
			"description": "MISC:https://git.kernel.org/stable/c/a7268e8a227d5a4f0bd1584f556246b0224ab274"
		},
		{
			"url": "https://git.kernel.org/stable/c/b9c87ce3bc6331f82811a8cf8e930423c22523a3",
			"description": "MISC:https://git.kernel.org/stable/c/b9c87ce3bc6331f82811a8cf8e930423c22523a3"
		},
		{
			"url": "https://git.kernel.org/stable/c/ef1067d2baa847d53c9988510d99fb494de4d12c",
			"description": "MISC:https://git.kernel.org/stable/c/ef1067d2baa847d53c9988510d99fb494de4d12c"
		}
	]
}
